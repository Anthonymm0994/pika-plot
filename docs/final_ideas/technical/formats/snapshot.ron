// Pika-Plot Workspace Snapshot Example
// This file demonstrates the complete structure of a saved workspace

WorkspaceSnapshot(
    version: 1,
    created_at: "2024-01-15T10:30:45.123Z",
    
    // Current workspace mode and state
    mode: Canvas(
        nodes: {
            // Table node - imported CSV data
            "a1b2c3d4-e5f6-7890-abcd-ef1234567890": (
                position: (x: 100.0, y: 200.0),
                size: (x: 300.0, y: 200.0),
                node_type: Table(
                    source_path: "C:/data/sales_2024.csv",
                    table_name: "sales_2024",
                    import_options: (
                        delimiter: ',',
                        has_header: true,
                        quote_char: '"',
                        escape_char: Some('\\'),
                        null_values: ["", "NULL", "null", "N/A", "NA"],
                        sample_size: 10000,
                        type_inference: true,
                        encoding: "utf-8",
                        skip_rows: 0,
                        max_rows: None,
                    ),
                    schema: Some((
                        fields: [
                            (name: "date", data_type: "Date32", nullable: false),
                            (name: "product", data_type: "Utf8", nullable: false),
                            (name: "quantity", data_type: "Int64", nullable: false),
                            (name: "price", data_type: "Float64", nullable: false),
                            (name: "customer_id", data_type: "Utf8", nullable: true),
                        ],
                    )),
                    row_count: Some(125000),
                ),
                selected: false,
            ),
            
            // Query node - data transformation
            "b2c3d4e5-f6a7-8901-bcde-f23456789012": (
                position: (x: 500.0, y: 200.0),
                size: (x: 350.0, y: 250.0),
                node_type: Query(
                    sql: "SELECT 
    product,
    SUM(quantity) as total_quantity,
    AVG(price) as avg_price,
    COUNT(DISTINCT customer_id) as unique_customers
FROM sales_2024
WHERE date >= '2024-01-01'
GROUP BY product
ORDER BY total_quantity DESC",
                    input_tables: ["sales_2024"],
                    cached_result: None, // Results not included in snapshot
                ),
                selected: false,
            ),
            
            // Plot node - visualization
            "c3d4e5f6-a7b8-9012-cdef-345678901234": (
                position: (x: 900.0, y: 200.0),
                size: (x: 400.0, y: 400.0),
                node_type: Plot(
                    config: (
                        plot_type: Scatter,
                        title: Some("Product Performance Analysis"),
                        x_axis: (
                            column: "total_quantity",
                            label: Some("Total Quantity Sold"),
                            scale: Linear,
                            range: None,
                            tick_format: None,
                        ),
                        y_axis: (
                            column: "avg_price",
                            label: Some("Average Price ($)"),
                            scale: Linear,
                            range: None,
                            tick_format: Some("$.2f"),
                        ),
                        color_scale: Sequential("viridis"),
                        theme: Dark,
                        specific: Scatter(
                            x_column: "total_quantity",
                            y_column: "avg_price",
                            size_column: Some("unique_customers"),
                            color_column: None,
                            label_column: Some("product"),
                            point_size: 8.0,
                            opacity: 0.8,
                            jitter: None,
                        ),
                    ),
                    source_node: Some("b2c3d4e5-f6a7-8901-bcde-f23456789012"),
                    cached_data: None, // GPU buffers not serialized
                ),
                selected: true,
            ),
            
            // Another table node
            "d4e5f6a7-b8c9-0123-defa-456789012345": (
                position: (x: 100.0, y: 500.0),
                size: (x: 300.0, y: 200.0),
                node_type: Table(
                    source_path: "C:/data/customers.csv",
                    table_name: "customers",
                    import_options: (
                        delimiter: ',',
                        has_header: true,
                        quote_char: '"',
                        escape_char: Some('\\'),
                        null_values: ["", "NULL"],
                        sample_size: 5000,
                        type_inference: true,
                        encoding: "utf-8",
                        skip_rows: 0,
                        max_rows: None,
                    ),
                    schema: Some((
                        fields: [
                            (name: "customer_id", data_type: "Utf8", nullable: false),
                            (name: "name", data_type: "Utf8", nullable: false),
                            (name: "email", data_type: "Utf8", nullable: true),
                            (name: "country", data_type: "Utf8", nullable: false),
                            (name: "signup_date", data_type: "Date32", nullable: false),
                        ],
                    )),
                    row_count: Some(50000),
                ),
                selected: false,
            ),
            
            // Transform node example
            "e5f6a7b8-c9d0-1234-efab-567890123456": (
                position: (x: 500.0, y: 500.0),
                size: (x: 300.0, y: 150.0),
                node_type: Transform(
                    transform_type: Join,
                    parameters: {
                        "left_table": String("sales_2024"),
                        "right_table": String("customers"),
                        "join_type": String("inner"),
                        "left_on": String("customer_id"),
                        "right_on": String("customer_id"),
                    },
                ),
                selected: false,
            ),
            
            // Export node
            "f6a7b8c9-d0e1-2345-fabc-678901234567": (
                position: (x: 1350.0, y: 300.0),
                size: (x: 200.0, y: 100.0),
                node_type: Export(
                    format: Png(
                        width: 1920,
                        height: 1080,
                        dpi: 144,
                    ),
                    destination: Some("C:/exports/product_analysis.png"),
                ),
                selected: false,
            ),
        },
        
        // Connections between nodes
        connections: [
            (
                from: ("a1b2c3d4-e5f6-7890-abcd-ef1234567890", Output("data")),
                to: ("b2c3d4e5-f6a7-8901-bcde-f23456789012", Input("table_0")),
            ),
            (
                from: ("b2c3d4e5-f6a7-8901-bcde-f23456789012", Output("result")),
                to: ("c3d4e5f6-a7b8-9012-cdef-345678901234", Input("data")),
            ),
            (
                from: ("a1b2c3d4-e5f6-7890-abcd-ef1234567890", Output("data")),
                to: ("e5f6a7b8-c9d0-1234-efab-567890123456", Input("left")),
            ),
            (
                from: ("d4e5f6a7-b8c9-0123-defa-456789012345", Output("data")),
                to: ("e5f6a7b8-c9d0-1234-efab-567890123456", Input("right")),
            ),
            (
                from: ("c3d4e5f6-a7b8-9012-cdef-345678901234", Output("plot")),
                to: ("f6a7b8c9-d0e1-2345-fabc-678901234567", Input("content")),
            ),
        ],
        
        // Camera position for canvas view
        camera: (
            center: (x: 700.0, y: 350.0),
            zoom: 0.85,
        ),
    ),
    
    // Alternative: Notebook mode example
    // mode: Notebook(
    //     cells: [
    //         (
    //             id: "cell-001",
    //             cell_type: Table(
    //                 source_path: "data/sales.csv",
    //                 table_name: "sales",
    //                 import_options: (...),
    //                 schema: Some(...),
    //                 row_count: Some(10000),
    //             ),
    //             collapsed: false,
    //             execution_count: Some(1),
    //         ),
    //         (
    //             id: "cell-002",
    //             cell_type: Query(
    //                 sql: "SELECT * FROM sales WHERE amount > 100",
    //                 input_tables: ["sales"],
    //                 cached_result: None,
    //             ),
    //             collapsed: false,
    //             execution_count: Some(2),
    //         ),
    //         (
    //             id: "cell-003",
    //             cell_type: Markdown(
    //                 "# Sales Analysis\nThis notebook analyzes Q1 2024 sales data..."
    //             ),
    //             collapsed: false,
    //             execution_count: None,
    //         ),
    //     ],
    //     active_cell: Some(1),
    // ),
    
    // External data source references
    data_sources: [
        (
            original_path: "C:/data/sales_2024.csv",
            table_name: "sales_2024",
            import_options: (
                delimiter: ',',
                has_header: true,
                quote_char: '"',
                escape_char: Some('\\'),
                null_values: ["", "NULL", "null", "N/A", "NA"],
                sample_size: 10000,
                type_inference: true,
                encoding: "utf-8",
                skip_rows: 0,
                max_rows: None,
            ),
            file_hash: "sha256:a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456",
            file_size: 15728640, // 15 MB
            last_modified: "2024-01-10T08:15:30.000Z",
        ),
        (
            original_path: "C:/data/customers.csv",
            table_name: "customers",
            import_options: (
                delimiter: ',',
                has_header: true,
                quote_char: '"',
                escape_char: Some('\\'),
                null_values: ["", "NULL"],
                sample_size: 5000,
                type_inference: true,
                encoding: "utf-8",
                skip_rows: 0,
                max_rows: None,
            ),
            file_hash: "sha256:fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210",
            file_size: 5242880, // 5 MB
            last_modified: "2024-01-05T14:22:10.000Z",
        ),
    ],
    
    // Global settings
    theme: Dark,
    memory_limit: Some(8589934592), // 8 GB in bytes
) 